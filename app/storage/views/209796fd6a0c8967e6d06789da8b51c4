	
<?php $__env->startSection('content'); ?>

<div style="clear:both">
	<h2><b>Unpublished Videos</b></h2>
</div>

<?php if(empty($uVideos)): ?>
	<p>There are no unpublished videos.</p>
<?php else: ?>
	<table class="table table-bordered datatable" id="table-1">
		<thead>
			<tr>
				<th width="500">Video Title</th>				
				<th>Video Category</th>
				<th>Game Linked To</th>
				<th>Posted By</th>
				<th>Dated Posted</th>
				<th>View Count</th>
				<th width="265">Actions</th>
			</tr>
		</thead>
		<tbody>
			<?php foreach($uVideos as $video): ?>
			<tr>
				<td><a href="javascript:;" onclick="jQuery('#videoPreviewModal').appendTo(body).modal('show');jQuery('#frame').attr('src', '<?php echo $video->url; ?>');"><?php echo $video->title; ?></a></td>
				
				<td><?php echo $video->category; ?></td>
				<td><?php echo $video->game_title; ?></td>
				<td><?php echo $video->first_name . ' ' . $video->last_name; ?></td>
				<td><?php echo $video->posted_at; ?></td>
				<td><?php echo $video->views; ?></td>
				<td>
					<a style="float:left" data-id="<?php echo $video->id; ?>" class="publish-btn btn btn-success btn-sm btn-icon icon-left"><i class="entypo-publish"></i>Publish</a>
					<a style="float:left; margin-left: 5px;" href="videos/<?php echo $video->id; ?>/edit" class="btn btn-info btn-sm btn-icon icon-left"><i class="entypo-pencil"></i>Edit</a>
					<button style="float:left; margin-left: 5px;" data-id="<?php echo $video->id; ?>" class="delete-btn btn btn-danger btn-sm btn-icon icon-left"><i class="entypo-cancel"></i>Delete</button>
				</td>
			</tr>
			<?php endforeach; ?>	
		</tbody>
	</table>
<?php endif; ?>

<div style="clear:both">
	<h2><b>Published Videos</b></h2>
</div>

<?php if(empty($pVideos)): ?>
	<p>There are no published videos.</p>
<?php else: ?>
<table class="table table-bordered datatable" id="table-2">
	<thead>
		<tr>
			<th width="500">Video Title</th>			
			<th>Video Category</th>
			<th>Game Linked To</th>
			<th>Posted By</th>
			<th>Dated Posted</th>
			<th>View Count</th>
			<th width="180">Actions</th>
		</tr>
	</thead>
	<tbody>
		<?php foreach($pVideos as $video): ?>
		<tr>
			<td><a target="_blank" href="<?php echo $video->url; ?>"><?php echo $video->title; ?></a></td>
			<td><?php echo $video->category; ?></td>
			<td><?php echo $video->game_title; ?></td>
			<td><?php echo $video->first_name . ' ' . $video->last_name; ?></td>
			<td><?php echo $video->posted_at; ?></td>
			<td><?php echo $video->views; ?></td>
			<td>
				<a style="float:left" data-id="<?php echo $video->id; ?>" class="unpublish-btn btn btn-gold btn-sm btn-icon icon-left"><i class="entypo-publish"></i>Unpublish</a>
				<a style="float:left; margin-left: 5px;" href="videos/<?php echo $video->id; ?>/edit" class="btn btn-info btn-sm btn-icon icon-left"><i class="entypo-pencil"></i>Edit</a>
			</td>
		</tr>
		<?php endforeach; ?>
	</tbody>
</table>
<?php endif; ?>

<!-- <script src="<?php echo URL::asset('assets/js/custom/list-functions.js'); ?>"></script> -->

<?php if(! empty($uVideos)): ?>
	<!-- Modals -->
	<?php echo $__env->make('modals.video-preview-modal', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
<?php endif; ?>

<script type="text/javascript">	
	$(document).ready(function() {

		//publish video
		$('.publish-btn').click(function() {
			$video_id = $(this).attr('data-id');
			bootbox.dialog({
			  message: "Are you sure you want to publish this video?",
			  title: "Confirmation",
			  buttons: {
			    danger: {
			      label: "Cancel",
			      className: "btn-default",
			      callback: function() {
			    	// do nothing
			      }
			    },
			    success: {
			      label: "Publish",
			      className: "btn-success",
			      callback: function() {
			      	$.ajax({
				        url: 'videos/' + $video_id + '/publish',
				        type: 'post',
				        success:function(msg){
				        	location.reload();
				        }
					});
			      }
			    }
			  }
			});
		});

		//unpublish video
		$('.unpublish-btn').click(function() {
			$video_id = $(this).attr('data-id');
			bootbox.dialog({
			  message: "Are you sure you want to unpublish this video?",
			  title: "Confirmation",
			  buttons: {
			    danger: {
			      label: "Cancel",
			      className: "btn-default",
			      callback: function() {
			    	// do nothing
			      }
			    },
			    success: {
			      label: "Unpublish",
			      className: "btn-gold",
			      callback: function() {
			      	$.ajax({
				        url: 'videos/' + $video_id + '/unpublish',
				        type: 'post',
				        success:function(msg){
				        	location.reload();
				        }
					});
			      }
			    }
			  }
			});
		});


		//delete video
		$('.delete-btn').click(function() {
			$video_id = $(this).attr('data-id');
			bootbox.dialog({
			  message: "Are you sure you want to delete this video?",
			  title: "Confirmation",
			  buttons: {
			    danger: {
			      label: "Cancel",
			      className: "btn-default",
			      callback: function() {
			    	// do nothing
			      }
			    },
			    success: {
			      label: "Delete",
			      className: "btn-danger",
			      callback: function() {
			      	$.ajax({
				        url: '/videos/' + $video_id,
				        type: 'post',
				        data: {_method: 'delete'},
				        success:function(msg){
				        	location.reload();
				        }
					});
			      }
			    }
			  }
			});
		});
	});
</script>

<?php $__env->stopSection(); ?>
<?php echo $__env->make('admin.layouts.admin-default', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>